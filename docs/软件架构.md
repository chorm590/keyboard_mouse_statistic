# A. 数据库

internal class DBManager 

​	顶级类。C部应从这里取得具体的数据

internal class SQLiteManager

​	SQLite的管理类。负责管理实现CURD的实例以及数据库的分文件管理。

internal class SQLiteHelper

​	SQLite的CURD实现类。

internal class SQLiteMemoryDB

​	内存数据库实例。可通过配置开关是否在内存中暂存数据。

internal class SQLiteDB

​	将数据存入SQL数据库中的实现。





数据库设计：

软件采用 SQLite 数据库存储事件数据。

在软件根目录下创建 db 目录，目录内按年份创建子目录，对应年份子目录下按月份创建数据库文件。

每个数据库中按天创建数据表，每天的数据数据分四张表来存储。同时，每月份数据库中还有一张表用于存储当月统计数据。具体的定义如下：

```
数据库文件相对路径：db/年号/
数据库文件名称：kms年号月号.db
示例：./db/2021/kms202101.db
```

```
每个数据库中的当月数据统计表名：summary
每日事件数据表名称：day日号_类别
每日事件数据表名示例1/4:day1_keyboard
每日事件数据表名示例2/4:day1_mouse
每日事件数据表名示例3/4:day1_combo
每日事件数据表名示例4/4:day1_summary
```

```
summary表结构：
_id SMALLINT pk
type SMALLINT
event TINYINT
keycode SMALLINT
area TINYINT
```













# B. UI

只用一个界面完成所有展示。

左上角展示总览信息，右上角展示所有按键数据的条形图。下方展示多样化统计信息，包括条形图，折线图。

通过Binding连接及更新数据。





# C. 程序逻辑

1. 日志模块

2. 时间管理模块

3. 数据库认证管理

   数据库与机器认证绑定或通过用户绑定。

4. 库表设计

5. 数据处理

6. 统计管理

7. 键鼠事件监听

   全局事件

   键盘：

     1、所有按键事件

   鼠标：

     1、鼠标移动的距离；

     2、左右按键的点击次数；

     3、滚轮的滚动格数；

     4、滚轮的点击次数。

8. 工具栏图标

9. ~~文件管理~~

10. 配置管理

    XML管理

